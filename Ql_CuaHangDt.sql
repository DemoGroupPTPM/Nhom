CREATE DATABASE Ql_CuaHangDT
USE Ql_CuaHangDT
GO
CREATE TABLE CHUCNANG
(
	MACHUCNANG NVARCHAR(10) PRIMARY KEY,
	TENCHUCNANG NVARCHAR(50)
)

INSERT INTO CHUCNANG VALUES('CN001', N'Tạo Tài Khoản Nhân Viên')
INSERT INTO CHUCNANG VALUES('CN002', N'Lập Hóa Đơn')
INSERT INTO CHUCNANG VALUES('CN003', N'Nhập Kho')
INSERT INTO CHUCNANG VALUES('CN004', N'Xuất Kho')
INSERT INTO CHUCNANG VALUES('CN005', N'Kiểm Kho')
INSERT INTO CHUCNANG VALUES('CN006', N'Thống Kê')
INSERT INTO CHUCNANG VALUES('CN007', N'Lập Phiếu Giao Hàng')
INSERT INTO CHUCNANG VALUES('CN008', N'Tạo Thẻ Khách Hàng')
INSERT INTO CHUCNANG VALUES('CN009', N'Tra Cứu Thông Tin Khách Hàng')
INSERT INTO CHUCNANG VALUES('CN010', N'Lập Phiếu Đổi Trả')
INSERT INTO CHUCNANG VALUES('CN011', N'Lấy Thông Tin Khách Hàng')
INSERT INTO CHUCNANG VALUES('CN012', N'Lấy Thông Tin Hóa Đơn')
--INSERT INTO CHUCNANG VALUES('CN013', N'Vận Chuyển')

CREATE TABLE PHANQUYEN(
	MAPHANQUYEN NVARCHAR(50) PRIMARY KEY,
	CHUTHICH NVARCHAR(100)
)

INSERT INTO PHANQUYEN VALUES ('PQQuanLy', N'Nhân Viên Quản Lý')
INSERT INTO PHANQUYEN VALUES ('PQBanHang', N'Nhân Viên Bán Hàng')
INSERT INTO PHANQUYEN VALUES ('PQThuNgan', N'Nhân Viên Thu Ngân')
INSERT INTO PHANQUYEN VALUES ('PQKho', N'Nhân Viên Kho')
--INSERT INTO PHANQUYEN VALUES ('PQVanChuyen', N'Nhân Viên Vận Chuyển')
select * from PHANQUYEN

CREATE TABLE CTPHANQUYEN
(
	MAPHANQUYEN NVARCHAR(50),
	MACHUCNANG NVARCHAR(10),
	CONSTRAINT PK_MAPQ_MACN PRIMARY KEY (MAPHANQUYEN,MACHUCNANG),
	CONSTRAINT FK_MAPQ_PHANQUYEN FOREIGN KEY (MAPHANQUYEN) REFERENCES PHANQUYEN(MAPHANQUYEN),
	CONSTRAINT FK_MACN_CHUCNANG FOREIGN KEY (MACHUCNANG) REFERENCES CHUCNANG(MACHUCNANG)
)
-- quản lý : tạo tk nv, kiểm kho,thống kê
--bán hàng: lấy thông tin khách hàng, lấy thông tin hóa đơn
--thu ngân:lập hóa đơn, tạo thẻ khách hàng, lập phiếu đổi trả,lập phiếu giao hàng
--kho hàng :xuất kho,kiểm kho, thống kê

INSERT INTO CTPHANQUYEN VALUES('PQQuanLy','CN001'),('PQQuanLy','CN005'),('PQQuanLy','CN006')
INSERT INTO CTPHANQUYEN VALUES('PQBanHang','CN011'),('PQBanHang','CN012')
INSERT INTO CTPHANQUYEN VALUES('PQThuNgan','CN002'),('PQThuNgan','CN008'),('PQThuNgan','CN010'),('PQThuNgan','CN007')
INSERT INTO CTPHANQUYEN VALUES('PQKho','CN004'),('PQKho','CN005'),('PQKho','CN006')
--INSERT INTO CTPHANQUYEN VALUES('PQVanChuyen','CN013')

CREATE TABLE NHANVIEN(
	MANV nvarchar(50) PRIMARY KEY,-- tên đăng nhập
	MATKHAU NVARCHAR(100),
	TENNV NVARCHAR(100),
	DIACHI NVARCHAR(100),
	DIENTHOAI NVARCHAR(10),
	MAPHANQUYEN NVARCHAR(50),
	CHUTHICH NVARCHAR(100),
	constraint FK_NV_QUYEN foreign key (MAPHANQUYEN) references PHANQUYEN(MAPHANQUYEN),
)
INSERT INTO NHANVIEN VALUES ('NV1',N'123',N'hùng',null,'0903655561','PQQuanLy',N'chủ cửa hàng')
INSERT INTO NHANVIEN VALUES ('NV2',N'123',N'thanh',N'11/29 dương đức hiền','0961231024','PQBanHang',N'bán hàng')

--select * from NHANVIEN

CREATE TABLE NHACUNGCAP(
	MANCC nvarchar(50) PRIMARY KEY,
	TENNCC NVARCHAR(100) ,
	DIACHI NVARCHAR(100),
	DIENTHOAI char(10),
	CHUTHICH NVARCHAR(100),
)
INSERT INTO NHACUNGCAP VALUES (N'NCC1',N'Công Ty TNHH Thế Giới Di Động',N'364 Cộng Hòa ,P. 13 ,Q. Tân Bình','0932115177',null)
INSERT INTO NHACUNGCAP VALUES (N'NCC2',N'Viettel TPHCM',N'285 Cách Mạng Tháng Tám, P. 12, Q. 10,','0942981657',null)
INSERT INTO NHACUNGCAP VALUES (N'NCC3',N'Phụ Kiện Buôn Bán',N'Số 117-119, Lý Chính Thắng, P. 7, Q. 3','0942014717',null)


CREATE TABLE KHACHHANG(
	MAKHACHHANG nvarchar(50) PRIMARY KEY,
	TENKHACHHANG NVARCHAR(100),
	DIACHI NVARCHAR(MAX),
	DIENTHOAI NVARCHAR(10),
	EMAIL NVARCHAR(50) NULL,
)

CREATE TABLE NHOMHANG(
	MANHOMHANG NVARCHAR(50) PRIMARY KEY,
	TENNHOMHANG NVARCHAR(100),
)
INSERT INTO NHOMHANG VALUES(N'NhomDIENTHOAI',N'Điện Thoại')
INSERT INTO NHOMHANG VALUES(N'NhomPHUKIEN',N'Phụ kiện')

CREATE TABLE LOAIHANG(
	MALOAI NVARCHAR(50) PRIMARY KEY,
	MANHOMHANG NVARCHAR(50),
	TENLOAI NVARCHAR(100),
	constraint FK_LOAIHANG_NHOMHANG  foreign key (MANHOMHANG) references NHOMHANG(MANHOMHANG),
)
INSERT INTO LOAIHANG VALUES(N'Loai1',N'NhomPHUKIEN',N'Sạc, cáp')
INSERT INTO LOAIHANG VALUES(N'Loai2',N'NhomPHUKIEN',N'Ốp lưng điện thoại')
INSERT INTO LOAIHANG VALUES(N'Loai3',N'NhomPHUKIEN',N'Cường lực điện thoại')
INSERT INTO LOAIHANG VALUES(N'Loai4',N'NhomDIENTHOAI',N'Điện thoại Iphone')
INSERT INTO LOAIHANG VALUES(N'Loai5',N'NhomDIENTHOAI',N'Điện thoại Xiaomi')
INSERT INTO LOAIHANG VALUES(N'Loai6',N'NhomDIENTHOAI',N'Điện thoại SamSung')



CREATE TABLE SANPHAM(
	MASP NVARCHAR(50) PRIMARY KEY,
	MALOAI NVARCHAR(50),
	TENHANG NVARCHAR(100),
	HINHANH NVARCHAR(MAX),
	DONGIA MONEY,
	SOLUONG INT,
	BAOHANH nvarchar(50),
	MANCC nvarchar(50),
	constraint FK_SANPHAM_LOAIHANG  foreign key (MALOAI) references LOAIHANG(MALOAI),
	constraint FK_SANPHAM_NHACUNGCAP  foreign key (MANCC) references NHACUNGCAP(MANCC),
)
--LOẠI 1 : SẠC, CÁP
INSERT INTO SANPHAM VALUES('SP1',N'Loai1',N'Sạc Nhanh LV0001', N'sacnhanh01.JPG',200000,'50',N'12 tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP2',N'Loai1',N'Sạc Nhanh LV0006', N'sacnhanh06.JPG',300000,'50',N'12 tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP3',N'Loai1',N'Cáp sạc LV0001', N'capsac01.JPG',150000,'50',N'12 tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP4',N'Loai1',N'Cáp sạc LV0006', N'capsac06.JPG',200000,'50',N'12 tháng',N'NCC1');
---loại 2 :ốp lưng điện thoại
INSERT INTO SANPHAM VALUES('SP5',N'Loai2',N'Ốp lưng Iphone 6/6s ', N'olip6.JPG',50000,'50',N'không bảo hành ',N'NCC2');
INSERT INTO SANPHAM VALUES('SP6',N'Loai2',N'Ốp lưng iphone 7/8 ', N'olip7.JPG',50000,'50',N'không bảo hành',N'NCC2');
INSERT INTO SANPHAM VALUES('SP7',N'Loai2',N'Ốp lưng iphone 6plus/6splus ', N'olip6pl.JPG',50000,'50',N'không bảo hành',N'NCC2');
INSERT INTO SANPHAM VALUES('SP8',N'Loai2',N'Ốp lưng iphone 7plus/8plus ', N'olip8pl.JPG',50000,'50',N'không bảo hành',N'NCC2');


INSERT INTO SANPHAM VALUES('SP9',N'Loai2',N'Ốp lưng xiaomi note', N'olxiaomi.JPG',50000,'50',N'không bảo hành',N'NCC3');
INSERT INTO SANPHAM VALUES('SP10',N'Loai2',N'Ốp lưng Samsung A ', N'olssA.JPG',50000,'50',N'không bảo hành',N'NCC3');
INSERT INTO SANPHAM VALUES('SP11',N'Loai2',N'Ốp lưng Samsung note ', N'olssN.JPG',50000,'50',N'không bảo hành',N'NCC3');
INSERT INTO SANPHAM VALUES('SP12',N'Loai2',N'Ốp lưng Samsung J ', N'olssJ.JPG',50000,'50',N'không bảo hành',N'NCC3');


---loại 3 cường lực điện thoại

INSERT INTO SANPHAM VALUES('SP24',N'Loai3',N'Cường lực iphone 6plus/7plus/8plus ', N'CL6P.JPG',50000,'50',N'không bảo hành',N'NCC3');
INSERT INTO SANPHAM VALUES('SP13',N'Loai3',N'Ốp lưng iphone X/XS ', N'CLipX.JPG',50000,'50',N'không bảo hành',N'NCC3');
INSERT INTO SANPHAM VALUES('SP14',N'Loai3',N'Ốp lưng iphone XR/11 ', N'CLipXR.JPG',50000,'50',N'không bảo hành',N'NCC3');

---LOẠI 4 ĐIỆN THOẠI IPHONE
INSERT INTO SANPHAM VALUES('SP15',N'Loai4',N' iphone 7plus/8plus ', N'ip8pl.JPG',10000000,'50',N'12 Tháng',N'NCC2');
INSERT INTO SANPHAM VALUES('SP16',N'Loai4',N' iphone X/XS ', N'ipX.JPG',15000000,'50',N'12 Tháng',N'NCC2');
INSERT INTO SANPHAM VALUES('SP17',N'Loai4',N' iphone XR ', N'ipXR.JPG',15000000,'50',N'k12 Tháng',N'NCC2');
--LOẠI 5 ĐIỆN THOẠI xiaomi
INSERT INTO SANPHAM VALUES('SP18',N'Loai5',N' xiaomi note ', N'xiaominote.JPG',10000000,'50',N'12 Tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP19',N'Loai5',N' xiaomi redmi ', N'xiaomiRedmi.JPG',8000000,'50',N'12 Tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP20',N'Loai5',N' xiaomi note 10plus', N'xiaomi10.JPG',6000000,'50',N'k12 Tháng',N'NCC1');
--LOẠI 6 ĐIỆN THOẠI ss
INSERT INTO SANPHAM VALUES('SP21',N'Loai6',N' Samsung A ', N'ssA.JPG',3000000,'50',N'12 Tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP22',N'Loai6',N' Samsung note ', N'ssN.JPG',15000000,'50',N'12 Tháng',N'NCC1');
INSERT INTO SANPHAM VALUES('SP23',N'Loai6',N' Samsung J ', N'ssJ.JPG',1500000,'50',N'k12 Tháng',N'NCC1')



--select * from SANPHAM
CREATE TABLE BAOHANH(
	MABAOHANH NVARCHAR(50) PRIMARY KEY,
	MAKHACHHANG nvarchar(50),
	MASP NVARCHAR(50),
	MANV nvarchar(50),
	YEUCAUBAOHANH NVARCHAR(MAX),
	NGAYNHAN DATE ,
	NGAYTRA DATE null,
	TINHTRANG NVARCHAR(50) default N'Đang tiến hành', 
	constraint FK_BAOHANH_KHOHANG foreign key (MASP) references SANPHAM(MASP),
	constraint FK_BAOHANH_KHACHHANG foreign key (MAKHACHHANG) references KHACHHANG(MAKHACHHANG),
	constraint FK_BAOHANH_NHANVIEN foreign key (MANV) references NHANVIEN(MANV)
)

CREATE TABLE PHIEUNHAP
(
	MAPN nvarchar(50) PRIMARY KEY,
	MANV nvarchar(50),
	MANCC nvarchar(50),
	NGAYLAP DATE,
	constraint FK_PHIEUNHAP_NV foreign key (MANV) references NHANVIEN(MANV),
	constraint FK_PHIEUNHAP_NCC  foreign key (MANCC) references NHACUNGCAP(MANCC),
)
CREATE TABLE CHITIETPHIEUNHAP(
	MACTPN nvarchar(50) ,
	MASP NVARCHAR(50),
	SOLUONG INT,
	GIAGOC MONEY,
	DONGIA MONEY,
	DONVITINH NVARCHAR(10) default N'Cái',
	THANHTIEN MONEY,
	CONSTRAINT PK_CHITIETPHIEUNHAP PRIMARY KEY (MACTPN, MASP),
	constraint FK_CHITIETPHIEUNHAP_PHIEUNHAP foreign key (MACTPN) references PHIEUNHAP(MAPN),
	constraint FK_CHITIETPHIEUNHAP_SANPHAM  foreign key (MASP) references SANPHAM(MASP),
)
CREATE TABLE PHIEUCHI(
	MAPHIEUCHI nvarchar(50) PRIMARY KEY,
	MAPN nvarchar(50) ,
	MANCC nvarchar(50) ,
	TONGTIEN MONEY,
	NGAYCHI DATE NULL,
	CHUTHICH NVARCHAR(MAX),
	constraint FK_PHIEUCHI_PHIEUNHAP foreign key (MAPN) references PHIEUNHAP(MAPN),
	constraint FK_PHIEUCHI_NCC  foreign key (MANCC) references NHACUNGCAP(MANCC),
)
CREATE TABLE HOADON(
	MAHD nvarchar(50) PRIMARY KEY,
	MAKHACHHANG nvarchar(50),
	MANV nvarchar(50) ,
	NGAYLAPPHIEU DATE,
	constraint FK_HOADON_MAKHACHHANG foreign key (MAKHACHHANG) references KHACHHANG(MAKHACHHANG),
	constraint FK_HOADON_NHANVIEN  foreign key (MANV) references NHANVIEN(MANV),
)
CREATE TABLE CHITIETHOADON(
	MAHD nvarchar(50), 
	MAHANG NVARCHAR(50),
	DONGIA MONEY,
	SOLUONG INT,
	DONVITINH NVARCHAR(10) default N'Cái' ,
	THANHTIEN MONEY,
	CONSTRAINT PK_CCHITIETHOADON PRIMARY KEY (MAHD, MAHANG),
	constraint FK_CHITIETHOADON_HOADON foreign key (MAHD) references HOADON(MAHD),
	constraint FK_CHITIETHOADON_KHOHANG  foreign key (MAHANG) references HOADON(MAHD),
)
CREATE TABLE PHIEUTHU(
	MAPHIEUTHU nvarchar(50) PRIMARY KEY,
	MAHD nvarchar(50),
	NGAYTHU DATE,
	TONGTIEN MONEY,
	constraint FK_PHIEUTHU_PHIEUXUAT foreign key (MAHD) references HOADON(MAHD),
)
